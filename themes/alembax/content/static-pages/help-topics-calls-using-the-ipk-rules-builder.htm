[viewBag]
title = "Using IPK Workflow Rules"
url = "/help/topics/calls/using-the-ipk-rules-builder"
layout = "help"
is_hidden = 0
navigation_hidden = 0
==
                                                    <h1>
<a name="aanchor247"></a>
                                                        <concept term="IPK"></concept>Using IPK Workflow Rules</h1>
                                                    <p>The IPK Workflow Rules enable you to set up rules and workflows defining the action(s) to be taken at different phases of a call, namely log/update, resolution and closure. </p>
                                                    <p>The IPK Workflow Rules enable you to define Rules (a set of criteria), define Workflows (a set of actions), and finally link the rules and workflows. The Call History window displays whether a rule was run or overridden by the analyst working on the call.</p>
                                                    <h2>
<a name="About"></a>About IPK Rules</h2>
                                                    <p>An IPK Rule determines the course of action to be taken on a call based on its attributes and their value. Whenever a call is logged/updated, resolved or closed, <span class="GeneralVariablesProductName">ASM</span> will evaluate the IPK rules defined in the system, and see if any of the details in the current call match any criteria specified on an IPK rule. When there is a matching IPK rule on a call, any workflows linked to this call will be run.</p>
                                                    <p>When a call is logged using a call template (for example, when a service request is logged), IPK workflow rules will override any recipient analyst/group specified on the call template. </p>
                                                    <p>The IPK Rules are run when the <b>Defer</b> and <b>Forward</b> buttons are pressed on the <b>Call Details</b> window.</p>
                                                    <h2>About IPK Workflows</h2>
                                                    <p>An IPK Workflow defines the activities that will occur at each of the above phases, provided an IPK rule has been picked up. These activities could be call assignment, sending notification, selecting forums, and raising Requests For Change for more complex service requests. </p>
                                                    <p>If you create an IPK Workflow Rule that does not have any criteria specified, that rule will be found as a match for all calls. Therefore, it is recommended that the Continue option be selected when creating IPK Workflow Rules if you want the system to continue to search for matching rules after a blank rule. It should also be noted that rules without workflows or actions will not be listed in the call history. </p>
                                                    <p>You can create the following workflows in <span class="GeneralVariablesProductName">ASM</span>:</p>
                                                    <ul>
                                                        <li value="1">Assignment Workflows</li>
                                                        <li value="2">Notification Workflows</li>
                                                        <li value="3">Forum Workflows</li>
                                                        <li value="4">Request Workflows</li>
                                                    </ul>
                                                    <p>An IPK Workflow Rule can only run one rule at a time at any stage of a call, but a workflow can be re-used and linked to different rules. When a call is closed and subsequently reopened, and you defer or forward that call, the system will try to detect a matching rule to run. If the matching rule has been run on the call once, it will not be run again. If the matching rule has not been run on the call, and is higher in the list of rules than the rule previously run, the matching rule will be run. Rules are not run when a call is saved, a note is added to a call, or an object is uploaded because these actions do not update the core call details that trigger IPK workflow rules.</p>
                                                    <h2>Steps Involved in Building a Rule</h2>
                                                    <h2 class="Prerequisite">Before you start</h2>
                                                    <p class="prereqtext1">The following settings must be in place before you can build a rule:</p>
                                                    <ul class="prereq">
                                                        <li value="1">
<b>IPK Workflow Rules Builder</b> must be enabled in <a href="../admin%20ipk%20management/ipk%20settings.htm">IPK Settings</a> .</li>
                                                        <li value="2">I<b>PK Workflow</b> must be selected in the <a href="../admin%20security%20roles/ipk%20management%20security%20roles%20-%20options%20tab.htm" class="MCXref xref">IPK Management Role: Options Tab</a> of your <b>IPK Management Security Role</b>.</li>
                                                    </ul>
                                                    <p>Take the following steps to build the rule:</p>
                                                    <ol>
                                                        <li value="1">If necessary, create the required <a href="creating%20an%20assignment%20workflow.htm" class="MCXref xref">Creating an Assignment Workflow</a>, <a href="creating%20a%20notification%20workflow.htm" class="MCXref xref">Creating a Notification Workflow</a>, <a href="creating%20a%20forum%20workflow.htm" class="MCXref xref">Creating a Forum Workflow</a>, and <a href="creating%20a%20request%20workflow.htm" class="MCXref xref">Creating a Request Workflow</a> workflows.</li>
                                                        <li value="2">
<a href="defining%20ipk%20workflow%20rules.htm" class="MCXref xref">Defining IPK Workflow Rules</a>.</li>
                                                        <li value="3">When a call is logged, <span class="GeneralVariablesProductName">ASM</span> searches for matching rules and runs them.</li>
                                                    </ol>
                                                    <h3>At what stages can an IPK Workflow Rule be run?</h3>
                                                    <p>IPK rules can be defined to run during one of three phases within the call lifecycle. The phase is defined when creating a workflow. </p>
                                                    <p>When an IPK rule is picked up in a defined phase, the workflows linked to the rule and which are defined to run in this phase may then run. The phases within the call lifecycle are the following:</p>
                                                    <ul>
                                                        <li value="1">
<b>Call Log/Update</b> – this is when the call is first logged or when the call details are updated to meet the Rule criteria. Any action taken on a call (i.e. forward internally, externally, or defer) before it is resolved or closed will belong to this phase. You can run Assignment, Notification, Forum, and Request Workflows in this phase.</li>
                                                        <li value="2">
<b>Call Resolve</b> – this is when the call is resolved. You can only run Assignment and Notification Workflows in this phase.</li>
                                                        <li value="3">
<b>Call Close</b> – this is when the call is closed. You can only run Notification Workflows in this phase.</li>
                                                    </ul>
                                                    <p>You should be aware that a workflow will only run in a phase when all the right conditions have been met. Once an IPK rule has been run in a phase, it will not be run again within this phase. For example, if Rule X has triggered in the <b>Call Log/Update</b> stage and ran the workflows mapped to Rule X, the rule will not be triggered again within the Call Log/Update stage. This means that an IPK workflow can be run on a call only once during <b>Call Log/Update</b> and once at <b>Call Resolve</b> and once at <b>Call Close</b>. Even if the call is closed and reopened, the system will detect that the rule has run before. </p>
                                                    <p>While you can only trigger an IPK rule once per phase, workflows can be mapped to other IPK rules and can therefore be reused in this way. That is when another rule to which the workflows have been linked is triggered.</p>
                                                    <p class="exampletext">Consider two IPK rules. The first IPK rule has the criteria Priority = Standard, and has a notification workflow attached that will notify the user on call log/update, and at call resolve. The second IPK rule has the criteria Priority = Severe, and has a notification workflow attached that will notify the Third Line Support group on call log/update.</p>
                                                    <p>A user calls the service desk, and an analyst opens a new Call Details window, setting Priority = Standard. The analyst then defers the call, to find out more information; this is considered to be call log, since it is the first action taken on the call. At call log, <span class="GeneralVariablesProductName">ASM</span> scans the list of IPK rules and since the Priority is Standard, it picks up the first IPK rule and the notification workflow attached to it is run. Therefore, an email is sent to the user that their call has been logged. </p>
                                                    <p>When the analyst opens this call again, they add more information (the call priority is still Standard) and click Internal, to forward it to the Network group; this is considered to be call update, since the call has been actioned but is not yet resolved. Since the first IPK rule has already been run in the call log/update phase, no email is sent to the user again.</p>
                                                    <p>An analyst in the Network group takes action on the call, changes the Priority to Severe and clicks on Internal, to forward it to the Field Engineer group; this is again a call update. <span class="GeneralVariablesProductName">ASM</span> scans the list of IPK rules and picks up the second IPK rule. Since this rule has not yet been run in the call log/update phase, the Third Line Support group is sent an email.</p>
                                                    <p>An analyst in the Field Engineer group picks up the call, and performs the required actions. When they have completed this, they change the Priority back to standard and forward it back to the Network group as resolved; this is call resolve. When <span class="GeneralVariablesProductName">ASM</span> scans the list of IPK rules, it picks up the first IPK rule since the call Priority is Standard. Even though this rule has already been run on the call, it was during the call log/update phase. Now that the call is in the resolve phase, <span class="GeneralVariablesProductName">ASM</span> runs the first IPK rule again and notifies the user that the call has been resolved. </p>
                                                    <h3>When are IPK Rules Evaluated?</h3>
                                                    <p>IPK rules are run when a call is logged/updated, resolved, and/or closed.</p>
                                                    <p>IPK rules are evaluated from the <b>Call Details</b> window, when you click on the <b>Internal</b>, <b>External</b>, <b>Defer</b> or <b>Close</b> buttons.</p>
                                                    <p>Rules are not checked when you click on the <b>Save</b> button, since saving is not counted as an action.</p>
                                                    <p>If you have the <b>Evaluate on Call Internal/External/Defer Screen</b> option selected on the <a href="../admin%20ipk%20management/ipk%20settings.htm">IPK Settings</a> window in System Administration, IPK rules will also be evaluated on the <b>Forward Internally</b>, <b>Forward Externally</b> and <b>Call Defer</b> windows. This means that IPK rules can potentially be evaluated twice in one call action: first on the Call Details window, and then again once you complete the <b>Forward Internally</b>, <b>Forward Externally</b> or <b>Call Defer</b> window.</p>
                                                    <p>If only one IPK rule is picked up (that is, either on the <b>Call Details</b> window or the <b>Forward Call Internally</b>, <b>Forward Call Externally</b>, or <b>Defer Call</b> window), the workflows linked to this rule will be run. However if two IPK rules are picked up (that is, one on the <b>Call Details</b> window and another on the <b>Forward Call Internally</b>, <b>Forward Call Externally</b>, or <b>Defer Call</b> window), the higher of the two IPK rules (as defined on the <b>IPK Rules to Workflow Mapping</b> window) will be used.</p>
                                                    <p>This means that if the IPK rule picked up on the <b>Call Details</b> window is listed higher than the one picked up on the <b>Forward Call Internally</b>, <b>Forward Call Externally</b>, or <b>Defer Call</b> window, the workflows linked to the rule on the <b>Call Details</b> window will be used (that is, the IPK rule picked up on the <b>Forward Call Internally,</b> <b>Forward Call Externally,</b> or <b>Defer Call</b> window will be ignored). Otherwise, if the IPK rule picked up on the <b>Forward Call Internally</b>, <b>Forward Call Externally</b>, or <b>Defer Call</b> window is listed higher than the one picked up on the <b>Call Details</b> window, the workflows linked to the first IPK rule picked up (that is, on the <b>Call Details</b> window) will be discarded, and the workflows linked to the rule picked up on the <b>Forward Call Internally</b>, <b>Forward Call Externally</b>, or <b>Defer Call</b> window will be run.</p>
                                                    <p class="exampletext">The administrator of company Acme has defined two IPK rules. Rule 1 is picked up when the Call Priority is Severe, and is linked to an assignment workflow which forwards the call to the Service Desk Manager. Rule 2 is picked up when the Call Status is “Change Evaluation”, and is linked to an assignment workflow which forwards the call to the Change Management Group. A call is logged where the Call Priority is Severe. When the analyst clicks <b>Internal</b>, Rule 1 is picked up. A popup window displays, informing the analyst that an IPK rule has been found and asking them if they want to forward this call to the Service Desk Manager. The analyst overrides this rule, and goes to the <b>Forward Internally</b> window. Here, they update the call status to “Change Evaluation”. When they click on OK, Rule 2 is picked up. A popup window appears, informing the analyst that an IPK rule has been found and asking them if they want to forward this call to the Change Management Group. The analyst accepts this rule, and the call is forwarded to the Change Management Group.  </p>
                                                    <p class="exampletext">The administrator of company Acme has defined two IPK rules. Rule 1 is picked up when the Call Priority is Severe, and is linked to a notification workflow which sends an email to the Problem Management Group. Rule 2 is picked up when the Call Status is “Change Evaluation”, and is linked to a notification workflow which sends an email to the Change Management Group. Rule 2 is listed higher than Rule 1. A call is logged where the Call Priority is Severe. When the analyst clicks Internal, Rule 1 is picked up and the notification workflow to the Problem Management Group is stored by the system. The analyst is directed to the <b>Forward Internally</b> window. On the <b>Forward Internally</b> window, the analyst updates the call status to “Change Evaluation”. When they click OK, Rule 2 is picked up. Since Rule 2 is listed higher than Rule 1 on the <b>IPK Rules to Workflow Mapping</b> window, the workflows linked to Rule 2 will be run. The notification workflow to the Problem Management Group (that is, the workflow linked to Rule 1) is discarded. The call is forwarded to the analyst/group specified on the <b>Forward Internally</b> window, and a notification email is sent to the Change Management Group. </p>
                                                    <h3>How will I know when a rule is about to be run?</h3>
                                                    <p>Notification, forum and create workflows will always run automatically. You will not be notified that these workflows are being run on a call. The call history will be updated whenever a workflow is run.</p>
                                                    <p>Whenever an assignment rule is detected for a call, <span class="GeneralVariablesProductName">ASM</span> displays a message prompting you to run the rule or cancel it. This message is not displayed if your system has the <b>Auto Run Rules</b> option selected on the <a href="../admin%20ipk%20management/ipk%20settings.htm">IPK Settings</a> window. </p>
                                                    <p>If <b>Auto Run Rules</b> is cleared, a message will always be displayed before an assignment rule is run. This message depends on whether the Autorun option has been selected for that IPK rule or not. </p>
                                                    <ul>
                                                        <li value="1">If the IPK rule picked up has the <b>Autorun</b> option selected, a message will be displayed, telling you that an IPK rule has been picked up, and the call will be assigned to the designated analyst/group. </li>
                                                        <li value="2">Otherwise, if the IPK rule picked up has the <b>Autorun</b> option cleared, you will be prompted with a message that lets you choose to continue with the assignment, or override the assignment workflow (that is, the call will not be assigned to the designated analyst/group specified on the assignment workflow). If you override the rule (that is, choose not to assign the call to the designated analyst/group on the assignment workflow), all other linked rules that are part of the workflow mapping will still be run. </li>
                                                    </ul>
                                                    <p>On the <b>IPK Workflow Rule Found</b> popup window, which displays when <span class="GeneralVariablesProductName">ASM</span> picks up an assignment workflow, you may see the <b>Close FCB</b> and <b>Close Response</b> options. Select the relevant option to complete a First Call Back or Response escalation if there is a Service Level Agreement running on the call. Selecting the Close FCB or Close Resp. options indicates to the system that you have notified the user with regards to this call, and completes the First Call Back or Response components of the Service Level Agreement. </p>
                                                    <p class="exampletext">The MD of an IT Service Management company wants the Service Desk Manager to personally respond to all calls that have the priority set to “Critical”. She wants such calls to be assigned to the manager when they are logged. After the call is called, she wants that an email message be sent to all the technical managers to help resolve the issue. When the issue is resolved, the MD wants such calls to be sent to her for closure and also an email sent to the members of the technical team with details of the issue. To achieve this, an assignment workflow is created assigning calls with priority “Critical” to the Service Desk Manager when the calls are logged. A rule is set up for the priority, and linked to the assignment workflow for the rule to run. A notification and forum workflow are also created to send an email to the technical managers, and also build a forum of all the technical managers. This is so that all the technical managers can view the details of the call, and provide their suggestion to resolve the user’s issue. Once a solution has been identified and the user is intimated about this, another notification workflow sends an email to the technical managers with details of the resolution after which an assignment workflow is run to assign the call to the MD for closing. </p>
                                                